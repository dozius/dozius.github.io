<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Grave Rave: The Dead of Winter 2024</title>
  <link rel="stylesheet" type="text/css" href="style.css">
  <link rel="icon" href="../assets/icon.png" type="image/x-icon" />
  <link href="../assets/fontawesome-5.12.1/css/all.css" rel="stylesheet">
</head>

<body onload="generateSchedule()">
  <img id="event_flyer" src="flyer.jpg" alt="Event Flyer">

  <!-- <p id="title"><a href="https://cyberdoof.com/plh-xfzu-hgv" target="_blank">Join The Fun In Cyberspace</a></p> -->
  <p id="notes">A link to join the event on Cyberdoof will be available here when the event goes live!</p>

  <p id="title">Schedule</p>
  <p id="notes">All times shown in your local time zone</p>

  <div id="links">
    <!-- generated by script -->
  </div>

  <p id="title">Discord</p>
  <p id="notes">
    Chat and share videos and screenshots from the event!<br>
    <a href="https://discord.gg/mtq4wqrJ5N" target="_blank">Discord Invite</a>
  </p>

  <script src='../luxon.min.js'></script>

  <script type="text/javascript">
    class EventSchedule {
      // Construct with event start time
      constructor(year, month, day, hour, minute)
      {
        var dateTime = luxon.DateTime;
        this.#currentTime = dateTime.local(year, month, day, hour, minute, { zone: this.#timeZone });
      }

      // Adds a set to the schedule
      addSet(twitchName, artistName, setLengthMinutes)
      {
        this.#data.push({
        "time": this.#currentTime.toLocal().toFormat(this.#timeStringFormat),
        "link": this.#baseUrl + twitchName,
        "artist": artistName});

        this.#currentTime = this.#currentTime.plus({ minutes: setLengthMinutes });
      }

      // Total number of sets in the schedule
      length()
      {
        return this.#data.length;
      }

      // Get the set located at the index
      at(index)
      {
        return this.#data[index];
      }

      #data = [];
      #timeZone = 'America/Toronto';
      #timeStringFormat = "yyyy-MM-dd hh:mm a";
      #baseUrl = "https://www.twitch.tv/";
      #currentTime;
    }

    function generateSchedule()
    {
      var schedule = new EventSchedule(2024, 2, 3, 20, 0);

      schedule.addSet("crabsuitlando", "CrabsuitLando", 60);
      schedule.addSet("skullzy_p",     "Skullzy",       60);
      schedule.addSet("wombra",        "Wombra",        60);
      schedule.addSet("totorobyn",     "TotoRobyn",     60);
      schedule.addSet("wornturtle",    "WornTurtle",    60);
      schedule.addSet("5qrlmusic",     "5QRL",          60);

      for (var i = 0; i < (schedule.length()); i++) {
        var link = document.createElement("a");
        link.setAttribute("class", "link_box");
        link.setAttribute('target', "_blank");
        link.setAttribute("href", schedule.at(i).link);

        var link_time = document.createElement("div");
        link_time.setAttribute("class", "link_time");
        link_time.innerHTML = schedule.at(i).time;

        var link_artist = document.createElement("div");
        link_artist.setAttribute("class", "link_artist");
        link_artist.innerHTML = schedule.at(i).artist;

        link.appendChild(link_time);
        link.appendChild(link_artist);
        document.getElementById('links').appendChild(link);
      }
     }
  </script>
</body>

</html>
